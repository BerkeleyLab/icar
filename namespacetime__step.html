<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>The Intermediate Complexity Atmospheric Research model (ICAR): time_step Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Types&nbsp;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="namespaces.html"><span>Modules&nbsp;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>time_step Module Reference</h1>
<p>---------------------------------------------------------------------------- Main <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> stepping module. Calculates a stable <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step (dt) and loops over physics calls Also updates boundaries every <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step.  
<a href="#_details">More...</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#acb28dd872d2a7e0e9f322753cb9debe7">boundary_update</a> (curdata, dXdt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Update the edges of curdata by adding dXdt  <a href="#acb28dd872d2a7e0e9f322753cb9debe7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#ab024d227ede8d503dbe333dd3b38515a">forcing_update</a> (domain, bc, options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Updated all fields in domain using the respective dXdt variables  <a href="#ab024d227ede8d503dbe333dd3b38515a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#ac561f85b36df27574da9e51a9c2abf7e">diagnostic_update</a> (domain, options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Update model diagnostic fields  <a href="#ac561f85b36df27574da9e51a9c2abf7e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#a8025c66a1ce7a20f1e55f887bfda77d2">apply_dt</a> (bc, nsteps, options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Uses the dt from <a class="el" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e" title="------------------------------------------------------------ Step forward one IO...">step()</a> to convert the forcing increments to per/time step increments  <a href="#a8025c66a1ce7a20f1e55f887bfda77d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#a071d3542c8dad198d87f0200a67f0ebc">compute_dt</a> (dx, u, v, w, CFL, cfl_strictness)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Calculate the maximum stable <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step given some CFL criteria  <a href="#a071d3542c8dad198d87f0200a67f0ebc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e">step</a> (domain, options, bc, model_time, next_output)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Step forward one IO <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step.  <a href="#a1fa24d7c8ca87a3a10b4dcbd0037b43e"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#afb2031a70b54b142fbdb8b4ab4782606">lastw</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#aca0ae7d61d0455fdc264f9582ea624cb">currw</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#ad30b05f7022f1178627bbce31b04146a">uw</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#a035d9e813392182f2f69f305d15303cd">vw</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#ac4fa668be7a3cdb0ece51a784064b710">temporaries</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#a46983c82a6a7e4c191bf16be9a4b422e">used</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#ad615bfc938a03fa37109125213892edf">to</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#ad1ecfdc73828c2b7006c547acb52486d">compute</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#aa82e51241474cb9ce42ede87532f1deb">diagnostic</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#afdff29c953152b30b1e38a9bf7feb5c4">w_real</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetime__step.html#a9a59d75366aaf60da0e59535d2d6d858">field</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>---------------------------------------------------------------------------- Main <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> stepping module. Calculates a stable <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step (dt) and loops over physics calls Also updates boundaries every <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Ethan Gutmann (<a href="mailto:gutmann@ucar.edu">gutmann@ucar.edu</a>)</dd></dl>
<p>---------------------------------------------------------------------------- </p>
<hr/><h2>Function/Subroutine Documentation</h2>
<a class="anchor" id="a8025c66a1ce7a20f1e55f887bfda77d2"></a><!-- doxytag: member="time_step::apply_dt" ref="a8025c66a1ce7a20f1e55f887bfda77d2" args="(bc, nsteps, options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine time_step::apply_dt </td>
          <td>(</td>
          <td class="paramtype">type(bc_type),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&nbsp;</td>
          <td class="paramname"> <em>nsteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type),intent(in)&nbsp;</td>
          <td class="paramname"> <em>options</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>------------------------------------------------------------ Uses the dt from <a class="el" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e" title="------------------------------------------------------------ Step forward one IO...">step()</a> to convert the forcing increments to per/time step increments </p>
<p>Divides dXdt variables by n timesteps so that after adding it N times we will be at the correct final value.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bc</em>&nbsp;</td><td>Boundary conditions structure containing dXdt variables </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nsteps</em>&nbsp;</td><td>Number of <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> steps calculated in <a class="el" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e" title="------------------------------------------------------------ Step forward one IO...">step()</a> function </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>Model options structure specifies which variables need to be updated</td></tr>
  </table>
  </dd>
</dl>
<p>------------------------------------------------------------ </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_a8025c66a1ce7a20f1e55f887bfda77d2_icgraph.png" border="0" usemap="#namespacetime__step_a8025c66a1ce7a20f1e55f887bfda77d2_icgraph_map" alt=""></div>
<map name="namespacetime__step_a8025c66a1ce7a20f1e55f887bfda77d2_icgraph_map" id="namespacetime__step_a8025c66a1ce7a20f1e55f887bfda77d2_icgraph">
<area shape="rect" id="node3" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Step forward one IO..." alt="" coords="189,5,301,35"/><area shape="rect" id="node5" href="driver_8f90.html#ab1e5a5816a57fc6e95d9563c2bb53590" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Main Program" alt="" coords="349,5,392,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acb28dd872d2a7e0e9f322753cb9debe7"></a><!-- doxytag: member="time_step::boundary_update" ref="acb28dd872d2a7e0e9f322753cb9debe7" args="(curdata, dXdt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine time_step::boundary_update </td>
          <td>(</td>
          <td class="paramtype">real,dimension(:,:,:),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>curdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real,dimension(:,:,:),intent(in)&nbsp;</td>
          <td class="paramname"> <em>dXdt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>------------------------------------------------------------ Update the edges of curdata by adding dXdt </p>
<p>Apply dXdt to the boundaries of a given data array. For these variables, dXdt is a small array just storing the boundary increments</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>curdata</em>&nbsp;</td><td>data array to be updated </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dXdt</em>&nbsp;</td><td>Array containing increments to be applied to the boundaries. (nz x max(nx,ny) x 4)</td></tr>
  </table>
  </dd>
</dl>
<p>------------------------------------------------------------ </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_acb28dd872d2a7e0e9f322753cb9debe7_icgraph.png" border="0" usemap="#namespacetime__step_acb28dd872d2a7e0e9f322753cb9debe7_icgraph_map" alt=""></div>
<map name="namespacetime__step_acb28dd872d2a7e0e9f322753cb9debe7_icgraph_map" id="namespacetime__step_acb28dd872d2a7e0e9f322753cb9debe7_icgraph">
<area shape="rect" id="node3" href="namespacetime__step.html#ab024d227ede8d503dbe333dd3b38515a" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Updated all fields in..." alt="" coords="241,5,412,35"/><area shape="rect" id="node5" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Step forward one IO..." alt="" coords="461,5,573,35"/><area shape="rect" id="node7" href="driver_8f90.html#ab1e5a5816a57fc6e95d9563c2bb53590" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Main Program" alt="" coords="621,5,664,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a071d3542c8dad198d87f0200a67f0ebc"></a><!-- doxytag: member="time_step::compute_dt" ref="a071d3542c8dad198d87f0200a67f0ebc" args="(dx, u, v, w, CFL, cfl_strictness)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real time_step::compute_dt </td>
          <td>(</td>
          <td class="paramtype">real,intent(in)&nbsp;</td>
          <td class="paramname"> <em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real,dimension(:,:,:),intent(in)&nbsp;</td>
          <td class="paramname"> <em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real,dimension(:,:,:),intent(in)&nbsp;</td>
          <td class="paramname"> <em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real,dimension(:,:,:),intent(in)&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real,intent(in)&nbsp;</td>
          <td class="paramname"> <em>CFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&nbsp;</td>
          <td class="paramname"> <em>cfl_strictness</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>------------------------------------------------------------ Calculate the maximum stable <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step given some CFL criteria </p>
<p>For each grid cell, find the mean of the <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> speeds from each direction * sqrt(3) for the 3D <a class="el" href="namespaceadvection.html" title="---------------------------------------------------------------------------- Driver...">advection</a> CFL limited <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step Also find the maximum <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> speed anywhere in the domain to check against a 1D <a class="el" href="namespaceadvection.html" title="---------------------------------------------------------------------------- Driver...">advection</a> limit.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dx</em>&nbsp;</td><td>[ scalar ] horizontal grid cell width [m] </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>u</em>&nbsp;</td><td>[nx+1 x nz x ny] east west <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> speeds [m/s] </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>v</em>&nbsp;</td><td>[nx x nz x ny+1] North South <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> speed [m/s] </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>w</em>&nbsp;</td><td>[nx x nz x ny] vertical <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> speed [m/s] </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CFL</em>&nbsp;</td><td>[ scalar ] CFL limit to use (e.g. 1.0) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>dt [ scalar ] Maximum stable <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step [s]</dd></dl>
<p>------------------------------------------------------------ </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_a071d3542c8dad198d87f0200a67f0ebc_icgraph.png" border="0" usemap="#namespacetime__step_a071d3542c8dad198d87f0200a67f0ebc_icgraph_map" alt=""></div>
<map name="namespacetime__step_a071d3542c8dad198d87f0200a67f0ebc_icgraph_map" id="namespacetime__step_a071d3542c8dad198d87f0200a67f0ebc_icgraph">
<area shape="rect" id="node3" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Step forward one IO..." alt="" coords="208,5,320,35"/><area shape="rect" id="node5" href="driver_8f90.html#ab1e5a5816a57fc6e95d9563c2bb53590" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Main Program" alt="" coords="368,5,411,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac561f85b36df27574da9e51a9c2abf7e"></a><!-- doxytag: member="time_step::diagnostic_update" ref="ac561f85b36df27574da9e51a9c2abf7e" args="(domain, options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine time_step::diagnostic_update </td>
          <td>(</td>
          <td class="paramtype">type(domain_type),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type),intent(in)&nbsp;</td>
          <td class="paramname"> <em>options</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>------------------------------------------------------------ Update model diagnostic fields </p>
<p>Calculates most model diagnostic fields such as Psfc, 10m height winds and ustar</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>domain</em>&nbsp;</td><td>Model domain data structure to be updated </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>Model options (not used at present)</td></tr>
  </table>
  </dd>
</dl>
<p>------------------------------------------------------------ </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_ac561f85b36df27574da9e51a9c2abf7e_cgraph.png" border="0" usemap="#namespacetime__step_ac561f85b36df27574da9e51a9c2abf7e_cgraph_map" alt=""></div>
<map name="namespacetime__step_ac561f85b36df27574da9e51a9c2abf7e_cgraph_map" id="namespacetime__step_ac561f85b36df27574da9e51a9c2abf7e_cgraph">
<area shape="rect" id="node3" href="namespaceboundary__conditions.html#a2444404168e4c2647d5d469702aadc14" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Adjust the pressure..." alt="" coords="245,5,491,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_ac561f85b36df27574da9e51a9c2abf7e_icgraph.png" border="0" usemap="#namespacetime__step_ac561f85b36df27574da9e51a9c2abf7e_icgraph_map" alt=""></div>
<map name="namespacetime__step_ac561f85b36df27574da9e51a9c2abf7e_icgraph_map" id="namespacetime__step_ac561f85b36df27574da9e51a9c2abf7e_icgraph">
<area shape="rect" id="node3" href="namespacetime__step.html#ab024d227ede8d503dbe333dd3b38515a" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Updated all fields in..." alt="" coords="247,5,417,35"/><area shape="rect" id="node5" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Step forward one IO..." alt="" coords="467,32,579,61"/><area shape="rect" id="node7" href="driver_8f90.html#ab1e5a5816a57fc6e95d9563c2bb53590" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Main Program" alt="" coords="627,32,669,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab024d227ede8d503dbe333dd3b38515a"></a><!-- doxytag: member="time_step::forcing_update" ref="ab024d227ede8d503dbe333dd3b38515a" args="(domain, bc, options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine time_step::forcing_update </td>
          <td>(</td>
          <td class="paramtype">type(domain_type),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bc_type),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type),intent(in)&nbsp;</td>
          <td class="paramname"> <em>options</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>------------------------------------------------------------ Updated all fields in domain using the respective dXdt variables </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>domain</em>&nbsp;</td><td>full domain data structure to be updated </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bc</em>&nbsp;</td><td>boundary conditions (containing dXdt increments) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>options structure specifies which variables need to be updated</td></tr>
  </table>
  </dd>
</dl>
<p>------------------------------------------------------------ </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_ab024d227ede8d503dbe333dd3b38515a_cgraph.png" border="0" usemap="#namespacetime__step_ab024d227ede8d503dbe333dd3b38515a_cgraph_map" alt=""></div>
<map name="namespacetime__step_ab024d227ede8d503dbe333dd3b38515a_cgraph_map" id="namespacetime__step_ab024d227ede8d503dbe333dd3b38515a_cgraph">
<area shape="rect" id="node3" href="namespacewind.html#a7744a19247af8763f33df504e3f296f3" title="wind::balance_uvw" alt="" coords="256,5,389,35"/><area shape="rect" id="node5" href="namespacetime__step.html#acb28dd872d2a7e0e9f322753cb9debe7" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Update the edges of..." alt="" coords="229,59,416,88"/><area shape="rect" id="node7" href="namespacetime__step.html#ac561f85b36df27574da9e51a9c2abf7e" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Update model diagnostic..." alt="" coords="227,112,419,141"/><area shape="rect" id="node9" href="namespaceboundary__conditions.html#a2444404168e4c2647d5d469702aadc14" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Adjust the pressure..." alt="" coords="467,112,712,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_ab024d227ede8d503dbe333dd3b38515a_icgraph.png" border="0" usemap="#namespacetime__step_ab024d227ede8d503dbe333dd3b38515a_icgraph_map" alt=""></div>
<map name="namespacetime__step_ab024d227ede8d503dbe333dd3b38515a_icgraph_map" id="namespacetime__step_ab024d227ede8d503dbe333dd3b38515a_icgraph">
<area shape="rect" id="node3" href="namespacetime__step.html#a1fa24d7c8ca87a3a10b4dcbd0037b43e" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Step forward one IO..." alt="" coords="227,5,339,35"/><area shape="rect" id="node5" href="driver_8f90.html#ab1e5a5816a57fc6e95d9563c2bb53590" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Main Program" alt="" coords="387,5,429,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1fa24d7c8ca87a3a10b4dcbd0037b43e"></a><!-- doxytag: member="time_step::step" ref="a1fa24d7c8ca87a3a10b4dcbd0037b43e" args="(domain, options, bc, model_time, next_output)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine time_step::step </td>
          <td>(</td>
          <td class="paramtype">type(domain_type),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type),intent(in)&nbsp;</td>
          <td class="paramname"> <em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bc_type),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8,intent(inout)&nbsp;</td>
          <td class="paramname"> <em>model_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8,intent(inout)&nbsp;</td>
          <td class="paramname"> <em>next_output</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>------------------------------------------------------------ Step forward one IO <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step. </p>
<p>Calculated the internal model <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step to satisfy the CFL criteria, then updates all forcing update increments for that dt and loops through <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> calling physics modules. Also checks to see if it is <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> to write a model <a class="el" href="namespaceoutput.html" title="------------------------------------------------------------ Model Output">output</a> file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>domain</em>&nbsp;</td><td>domain data structure containing model state </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>model options structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bc</em>&nbsp;</td><td>model boundary conditions data structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>model_time</em>&nbsp;</td><td>Current internal model <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> (seconds since start of run) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>next_output</em>&nbsp;</td><td>Next <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> to write an <a class="el" href="namespaceoutput.html" title="------------------------------------------------------------ Model Output">output</a> file (in "model_time")</td></tr>
  </table>
  </dd>
</dl>
<p>------------------------------------------------------------ </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_a1fa24d7c8ca87a3a10b4dcbd0037b43e_cgraph.png" border="0" usemap="#namespacetime__step_a1fa24d7c8ca87a3a10b4dcbd0037b43e_cgraph_map" alt=""></div>
<map name="namespacetime__step_a1fa24d7c8ca87a3a10b4dcbd0037b43e_cgraph_map" id="namespacetime__step_a1fa24d7c8ca87a3a10b4dcbd0037b43e_cgraph">
<area shape="rect" id="node3" href="namespaceadvection.html#aefde991c5dab4e3586471bf718d73656" title="advection::advect" alt="" coords="200,59,325,88"/><area shape="rect" id="node13" href="namespacetime__step.html#a8025c66a1ce7a20f1e55f887bfda77d2" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Uses the dt from step()..." alt="" coords="195,113,331,143"/><area shape="rect" id="node15" href="namespacetime__step.html#a071d3542c8dad198d87f0200a67f0ebc" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Calculate the maximum..." alt="" coords="185,167,340,196"/><area shape="rect" id="node17" href="namespaceconvection.html#a41472c8d51793644bb02dd5f76916493" title="convection::convect" alt="" coords="193,220,332,249"/><area shape="rect" id="node27" href="namespacetime__step.html#ac561f85b36df27574da9e51a9c2abf7e" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Update model diagnostic..." alt="" coords="488,219,680,248"/><area shape="rect" id="node31" href="namespacetime__step.html#ab024d227ede8d503dbe333dd3b38515a" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Updated all fields in..." alt="" coords="177,324,348,353"/><area shape="rect" id="node38" href="namespaceland__surface.html#a68642d675513815a5b718074ebc2d581" title="land_surface::lsm" alt="" coords="200,539,325,568"/><area shape="rect" id="node72" href="namespacemicrophysics.html#ad2296bf9e02061a692cb9bebb6abcf7d" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Microphysical driver" alt="" coords="200,832,325,861"/><area shape="rect" id="node80" href="namespaceplanetary__boundary__layer.html#a5fb0203f82908b07f3a21c3d7d1edc15" title="planetary_boundary_layer::pbl" alt="" coords="165,939,360,968"/><area shape="rect" id="node84" href="namespaceradiation.html#aba1a06d27af96fe11d576458c8ccfe77" title="radiation::rad" alt="" coords="215,1005,311,1035"/><area shape="rect" id="node88" href="namespaceoutput.html#af3342d3af113847cf198209af5b08497" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Simple routine to write..." alt="" coords="192,1176,333,1205"/><area shape="rect" id="node5" href="namespaceadv__mpdata.html#a2e2aea99404d780746817bd1af8c4bd1" title="adv_mpdata::mpdata" alt="" coords="512,5,656,35"/><area shape="rect" id="node9" href="namespaceadv__upwind.html#ac5b36cd4fda4e02ade13dc42c3f1d35c" title="adv_upwind::upwind" alt="" coords="515,59,653,88"/><area shape="rect" id="node7" href="namespaceadv__mpdata.html#ac816cca0a7a2cce91c619686f0c75551" title="adv_mpdata::advect3d" alt="" coords="887,5,1041,35"/><area shape="rect" id="node11" href="namespaceadv__upwind.html#aa55cde9e774909e4f85a7ef439e78d35" title="adv_upwind::advect3d" alt="" coords="888,59,1040,88"/><area shape="rect" id="node19" href="namespacemodule__cu__tiedtke.html#a1a5681fb1c6951744459be1a695f9e84" title="module_cu_tiedtke::CU_TIEDTKE" alt="" coords="473,112,695,141"/><area shape="rect" id="node23" href="namespacemodule__cu__kf.html#afba26c25fd848257d1e39a5d898b6b09" title="module_cu_kf::KFCPS" alt="" coords="507,165,661,195"/><area shape="rect" id="node21" href="namespacemodule__cu__tiedtke.html#af856f45fac2108a558338cc6c5c85e0f" title="module_cu_tiedtke::TIECNV" alt="" coords="869,112,1059,141"/><area shape="rect" id="node25" href="namespacemodule__cu__kf.html#aa5fb231d87f373116b05c42e843c4235" title="module_cu_kf::KFPARA" alt="" coords="881,165,1047,195"/><area shape="rect" id="node29" href="namespaceboundary__conditions.html#a2444404168e4c2647d5d469702aadc14" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Adjust the pressure..." alt="" coords="841,219,1087,248"/><area shape="rect" id="node33" href="namespacewind.html#a7744a19247af8763f33df504e3f296f3" title="wind::balance_uvw" alt="" coords="517,272,651,301"/><area shape="rect" id="node35" href="namespacetime__step.html#acb28dd872d2a7e0e9f322753cb9debe7" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Update the edges of..." alt="" coords="491,325,677,355"/><area shape="rect" id="node40" href="namespaceland__surface.html#a7e3ca7f3603728ff47008943c2bc5dd5" title="land_surface::apply_fluxes" alt="" coords="496,379,672,408"/><area shape="rect" id="node42" href="namespaceland__surface.html#a91d5fd091cf016fb3312e53c3907d1c5" title="land_surface::calc_exchange_coefficient" alt="" coords="455,432,713,461"/><area shape="rect" id="node44" href="namespaceland__surface.html#a3c2a62e40169606db7a71db57364baea" title="land_surface::calc_mahrt_holtslag_exchange_coefficient" alt="" coords="409,485,759,515"/><area shape="rect" id="node48" href="namespacemodule__sf__noahdrv.html#a448a88b17ccd8008c5e959f192de7ca7" title="module_sf_noahdrv::lsm_noah" alt="" coords="485,539,683,568"/><area shape="rect" id="node52" href="namespacemodule__lsm__simple.html#aa60ff29fb7c437d56fe9fa0a7cfc798f" title="module_lsm_simple::lsm_simple" alt="" coords="479,592,689,621"/><area shape="rect" id="node64" href="namespaceland__surface.html#a8df2ebf310cddbb2ff4489483abc7db2" title="land_surface::sat_mr" alt="" coords="512,645,656,675"/><area shape="rect" id="node66" href="namespaceland__surface.html#a90a1f4fe91cb7cab64c843a545ce7cb6" title="land_surface::surface_diagnostics" alt="" coords="475,699,693,728"/><area shape="rect" id="node68" href="namespacemodule__water__simple.html#ad47e405cb5cf58757fb5425337139251" title="module_water_simple::water_simple" alt="" coords="468,752,700,781"/><area shape="rect" id="node46" href="namespaceland__surface.html#a497349e24755ebcab3668be1a35e8dce" title="land_surface::F2_formula" alt="" coords="880,405,1048,435"/><area shape="rect" id="node50" href="namespacemodule__sf__noahlsm.html#ae769ca32aabee96e27f82fd2dc8d0c40" title="module_sf_noahlsm::SFLX" alt="" coords="875,459,1053,488"/><area shape="rect" id="node54" href="namespacemodule__lsm__simple.html#a7917430537d70da25563482bac20e39c" title="module_lsm_simple::add_rain" alt="" coords="867,512,1061,541"/><area shape="rect" id="node56" href="namespacemodule__lsm__simple.html#a0fee3c60f3dfc3b36409e77e292d9a10" title="module_lsm_simple::calc_exchange_coefficient" alt="" coords="815,565,1113,595"/><area shape="rect" id="node58" href="namespacemodule__lsm__simple.html#a924f558b4123cab6e16c0b7c0f808f08" title="module_lsm_simple::calc_ground_heat" alt="" coords="841,619,1087,648"/><area shape="rect" id="node60" href="namespacemodule__lsm__simple.html#ae065f8a594a1ff0c54d6b1bd3bcf0698" title="module_lsm_simple::calc_latent_heat" alt="" coords="844,672,1084,701"/><area shape="rect" id="node62" href="namespacemodule__lsm__simple.html#a6ac1af4d14a6952c271d60a04452011a" title="module_lsm_simple::calc_sensible_heat" alt="" coords="836,725,1092,755"/><area shape="rect" id="node70" href="namespacemodule__water__simple.html#ace7c4e4aa33feb7cc94b3a2be7646e5c" title="module_water_simple::calc_exchange_coefficient" alt="" coords="809,779,1119,808"/><area shape="rect" id="node74" href="namespacemicrophysics.html#a675e77b21fd7c1041f6a6c87176bc4dc" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Distribute the microphysics..." alt="" coords="483,805,685,835"/><area shape="rect" id="node76" href="namespacemodule__mp__thompson.html#a9d504d4387110026eb3c8d8fe49d1072" title="module_mp_thompson::mp_gt_driver" alt="" coords="467,859,701,888"/><area shape="rect" id="node78" href="namespacemodule__mp__simple.html#a43521e0ddb2604cb6b25f7515764d996" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Driver code to control..." alt="" coords="463,912,705,941"/><area shape="rect" id="node82" href="namespacepbl__simple.html#abc8b7829bf996baa98bb10d2dcc9ec37" title="pbl_simple::simple_pbl" alt="" coords="507,965,661,995"/><area shape="rect" id="node86" href="namespacemodule__ra__simple.html#ad1c74605b2817f833d31e806f791e246" title="module_ra_simple::ra_simple" alt="" coords="489,1019,679,1048"/><area shape="rect" id="node90" href="namespacetime.html#a147739c1924e484a7542973676a7c1ea" title="time::calendar_date" alt="" coords="516,1072,652,1101"/><area shape="rect" id="node92" href="namespaceio__routines.html#ac4835ed66f2e10d8e5bb40f6122f0ca1" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Simple error handling..." alt="" coords="900,1176,1028,1205"/><area shape="rect" id="node94" href="namespaceoutput.html#abf88076008ba1520740fd573165ee72d" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Creates a new NetCDF..." alt="" coords="521,1176,647,1205"/><area shape="rect" id="node97" href="namespaceio__routines.html#af9a172e1db00dccf3059d2a88dfb4162" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Tests to see if a file..." alt="" coords="508,1229,660,1259"/><area shape="rect" id="node99" href="namespaceoutput.html#a92fd667efbd13e99735e947dc0344b30" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Set up the varids for..." alt="" coords="515,1283,653,1312"/><area shape="rect" id="node102" href="namespaceoutput.html#abbaeecac70df7edca0eba97e75fa9c7a" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Keeps accumulated precip..." alt="" coords="488,1336,680,1365"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="namespacetime__step_a1fa24d7c8ca87a3a10b4dcbd0037b43e_icgraph.png" border="0" usemap="#namespacetime__step_a1fa24d7c8ca87a3a10b4dcbd0037b43e_icgraph_map" alt=""></div>
<map name="namespacetime__step_a1fa24d7c8ca87a3a10b4dcbd0037b43e_icgraph_map" id="namespacetime__step_a1fa24d7c8ca87a3a10b4dcbd0037b43e_icgraph">
<area shape="rect" id="node3" href="driver_8f90.html#ab1e5a5816a57fc6e95d9563c2bb53590" title="&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; Main Program" alt="" coords="165,5,208,35"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ad1ecfdc73828c2b7006c547acb52486d"></a><!-- doxytag: member="time_step::compute" ref="ad1ecfdc73828c2b7006c547acb52486d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#ad1ecfdc73828c2b7006c547acb52486d">time_step::compute</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aca0ae7d61d0455fdc264f9582ea624cb"></a><!-- doxytag: member="time_step::currw" ref="aca0ae7d61d0455fdc264f9582ea624cb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#aca0ae7d61d0455fdc264f9582ea624cb">time_step::currw</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa82e51241474cb9ce42ede87532f1deb"></a><!-- doxytag: member="time_step::diagnostic" ref="aa82e51241474cb9ce42ede87532f1deb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#aa82e51241474cb9ce42ede87532f1deb">time_step::diagnostic</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9a59d75366aaf60da0e59535d2d6d858"></a><!-- doxytag: member="time_step::field" ref="a9a59d75366aaf60da0e59535d2d6d858" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#a9a59d75366aaf60da0e59535d2d6d858">time_step::field</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="afb2031a70b54b142fbdb8b4ab4782606"></a><!-- doxytag: member="time_step::lastw" ref="afb2031a70b54b142fbdb8b4ab4782606" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#afb2031a70b54b142fbdb8b4ab4782606">time_step::lastw</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac4fa668be7a3cdb0ece51a784064b710"></a><!-- doxytag: member="time_step::temporaries" ref="ac4fa668be7a3cdb0ece51a784064b710" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#ac4fa668be7a3cdb0ece51a784064b710">time_step::temporaries</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad615bfc938a03fa37109125213892edf"></a><!-- doxytag: member="time_step::to" ref="ad615bfc938a03fa37109125213892edf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#ad615bfc938a03fa37109125213892edf">time_step::to</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a46983c82a6a7e4c191bf16be9a4b422e"></a><!-- doxytag: member="time_step::used" ref="a46983c82a6a7e4c191bf16be9a4b422e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#a46983c82a6a7e4c191bf16be9a4b422e">time_step::used</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad30b05f7022f1178627bbce31b04146a"></a><!-- doxytag: member="time_step::uw" ref="ad30b05f7022f1178627bbce31b04146a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#ad30b05f7022f1178627bbce31b04146a">time_step::uw</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a035d9e813392182f2f69f305d15303cd"></a><!-- doxytag: member="time_step::vw" ref="a035d9e813392182f2f69f305d15303cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#a035d9e813392182f2f69f305d15303cd">time_step::vw</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="afdff29c953152b30b1e38a9bf7feb5c4"></a><!-- doxytag: member="time_step::w_real" ref="afdff29c953152b30b1e38a9bf7feb5c4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real,dimension(:,:),allocatable <a class="el" href="namespacetime__step.html#afdff29c953152b30b1e38a9bf7feb5c4">time_step::w_real</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 12 May 2016 for The Intermediate Complexity Atmospheric Research model (ICAR) by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
