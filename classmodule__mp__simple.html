<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>The Intermediate Complexity Atmospheric Research model (ICAR): module_mp_simple Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">The Intermediate Complexity Atmospheric Research model (ICAR)
   </div>
   <div id="projectbrief">A computationally efficient atmospheric model for downscaling.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Types</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="modulemodule__mp__simple-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">module_mp_simple Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><hr/>
<p> Very simple microphysics code modeled after the microphysics of SB04 used in Smith and Barstad '04 (the linear model).  
 <a href="classmodule__mp__simple.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3b5b540d9d511651c42ec6b3ba842796"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a3b5b540d9d511651c42ec6b3ba842796">mp_simple_driver</a> (pressure, th, pii, rho, qv, qc, qr, qs, rain, snow, dt, dz, nx, ny, nz)</td></tr>
<tr class="memdesc:a3b5b540d9d511651c42ec6b3ba842796"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Driver code to control simple microphysics  <a href="#a3b5b540d9d511651c42ec6b3ba842796">More...</a><br /></td></tr>
<tr class="separator:a3b5b540d9d511651c42ec6b3ba842796"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa47fc96f7112b5c4f9718b8f31c79c0c"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#aa47fc96f7112b5c4f9718b8f31c79c0c">sat_mr</a> (temperature, pressure)</td></tr>
<tr class="memdesc:aa47fc96f7112b5c4f9718b8f31c79c0c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Calculate the saturated mixing ratio for a given temperature and pressure  <a href="#aa47fc96f7112b5c4f9718b8f31c79c0c">More...</a><br /></td></tr>
<tr class="separator:aa47fc96f7112b5c4f9718b8f31c79c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0106ae6c82c8b14c49b4afd1871e12b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#aa0106ae6c82c8b14c49b4afd1871e12b">cloud_conversion</a> (pressure, temperature, qv, qc, qvsat, dt)</td></tr>
<tr class="memdesc:aa0106ae6c82c8b14c49b4afd1871e12b"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Convert cloud water to vapor and back  <a href="#aa0106ae6c82c8b14c49b4afd1871e12b">More...</a><br /></td></tr>
<tr class="separator:aa0106ae6c82c8b14c49b4afd1871e12b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012afbddb9dca5c40bc5bfbe63b275c8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a012afbddb9dca5c40bc5bfbe63b275c8">cloud2hydrometeor</a> (qc, q, conversion, qcmin)</td></tr>
<tr class="memdesc:a012afbddb9dca5c40bc5bfbe63b275c8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Convert cloud water or ice to rain or snow  <a href="#a012afbddb9dca5c40bc5bfbe63b275c8">More...</a><br /></td></tr>
<tr class="separator:a012afbddb9dca5c40bc5bfbe63b275c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf815931c9bfa8e29cd64e1133e8ac4d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#aaf815931c9bfa8e29cd64e1133e8ac4d">phase_change</a> (pressure, temperature, q1, qmax, q2, Lheat, change_rate)</td></tr>
<tr class="memdesc:aaf815931c9bfa8e29cd64e1133e8ac4d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Change the "phase" of a hydrometeor (e.g. evaporate rain)  <a href="#aaf815931c9bfa8e29cd64e1133e8ac4d">More...</a><br /></td></tr>
<tr class="separator:aaf815931c9bfa8e29cd64e1133e8ac4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa657f819d93fc905ac898e46b0551ce"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#afa657f819d93fc905ac898e46b0551ce">mp_conversions</a> (pressure, temperature, qv, qc, qr, qs, dt)</td></tr>
<tr class="memdesc:afa657f819d93fc905ac898e46b0551ce"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Compute microphysical conversions  <a href="#afa657f819d93fc905ac898e46b0551ce">More...</a><br /></td></tr>
<tr class="separator:afa657f819d93fc905ac898e46b0551ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a555961f80b8e520a047abf3220b1e6df"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a555961f80b8e520a047abf3220b1e6df">sediment</a> (q, v, rho, dz, n)</td></tr>
<tr class="memdesc:a555961f80b8e520a047abf3220b1e6df"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Compute sedimentation in a column  <a href="#a555961f80b8e520a047abf3220b1e6df">More...</a><br /></td></tr>
<tr class="separator:a555961f80b8e520a047abf3220b1e6df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e0bb6089333d9b063ba5f4e6f8127f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#ac6e0bb6089333d9b063ba5f4e6f8127f">mp_simple</a> (pressure, temperature, rho, qv, qc, qr, qs, rain, snow, dt, dz, nz, debug)</td></tr>
<tr class="memdesc:ac6e0bb6089333d9b063ba5f4e6f8127f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Basic microphysics code for a column of air  <a href="#ac6e0bb6089333d9b063ba5f4e6f8127f">More...</a><br /></td></tr>
<tr class="separator:ac6e0bb6089333d9b063ba5f4e6f8127f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aab329c4184d0117c28286394a41e5861"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#aab329c4184d0117c28286394a41e5861">lh_vapor</a> = 2.26E6</td></tr>
<tr class="separator:aab329c4184d0117c28286394a41e5861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0678d6241005e2b2b201388def7dea90"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a0678d6241005e2b2b201388def7dea90">dlhvdt</a> = 2400</td></tr>
<tr class="separator:a0678d6241005e2b2b201388def7dea90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06cd8ef0b9e1fc2acbd8421bb77bb50a"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a06cd8ef0b9e1fc2acbd8421bb77bb50a">lh_liquid</a> = 3.34E5</td></tr>
<tr class="separator:a06cd8ef0b9e1fc2acbd8421bb77bb50a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af436151c03526039c23d14802a6c3836"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#af436151c03526039c23d14802a6c3836">heat_capacity</a> = 1006.0</td></tr>
<tr class="separator:af436151c03526039c23d14802a6c3836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62767c1c8968f8d3507052ea35d65017"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a62767c1c8968f8d3507052ea35d65017">small_value</a> = 1E-15</td></tr>
<tr class="separator:a62767c1c8968f8d3507052ea35d65017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41e5eea160014156b15b696dec69b6e8"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a41e5eea160014156b15b696dec69b6e8">small_pressure</a> = 1000.</td></tr>
<tr class="separator:a41e5eea160014156b15b696dec69b6e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be4ef8579135d65ad9cb5fce3ce6ebd"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a1be4ef8579135d65ad9cb5fce3ce6ebd">snow_formation_time_const</a> = 1/2000.0</td></tr>
<tr class="separator:a1be4ef8579135d65ad9cb5fce3ce6ebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af786b5a9c3dccae266836ffa89cbeeb4"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#af786b5a9c3dccae266836ffa89cbeeb4">rain_formation_time_const</a> = 1/500.0</td></tr>
<tr class="separator:af786b5a9c3dccae266836ffa89cbeeb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76bdd584eebc03a02de1cfe7fb6b6d29"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a76bdd584eebc03a02de1cfe7fb6b6d29">freezing_threshold</a> = 273.15</td></tr>
<tr class="separator:a76bdd584eebc03a02de1cfe7fb6b6d29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37514913519ed61be4d1110e16159aa"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#ab37514913519ed61be4d1110e16159aa">snow_fall_rate</a> = 1.5</td></tr>
<tr class="separator:ab37514913519ed61be4d1110e16159aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded1e115bb1032ae4557732622b4a9ea"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#aded1e115bb1032ae4557732622b4a9ea">rain_fall_rate</a> = 10.0</td></tr>
<tr class="separator:aded1e115bb1032ae4557732622b4a9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6aabb86d8153a2242695dfec50b7ef7"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#af6aabb86d8153a2242695dfec50b7ef7">snow_cloud_init</a> = 0.00001</td></tr>
<tr class="separator:af6aabb86d8153a2242695dfec50b7ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c50949e2a0b73c5ec9d938fab2e4ee"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#af7c50949e2a0b73c5ec9d938fab2e4ee">rain_cloud_init</a> = 0.00001</td></tr>
<tr class="separator:af7c50949e2a0b73c5ec9d938fab2e4ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9e502020c8db2774ff11de20d8d6f0"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#afe9e502020c8db2774ff11de20d8d6f0">rain_evap</a> = 0.999</td></tr>
<tr class="separator:afe9e502020c8db2774ff11de20d8d6f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5c905567822928cb1a73d3ae083aa60"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#ae5c905567822928cb1a73d3ae083aa60">snow_evap</a> = 0.999</td></tr>
<tr class="separator:ae5c905567822928cb1a73d3ae083aa60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38dd23279d9dffd7f87eaf9e8fe4d047"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a38dd23279d9dffd7f87eaf9e8fe4d047">snow_melt</a> = 0.999</td></tr>
<tr class="separator:a38dd23279d9dffd7f87eaf9e8fe4d047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fc42fe6bda022c405d9758888edc8ee"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#a5fc42fe6bda022c405d9758888edc8ee">cloud2rain</a> = 0.999</td></tr>
<tr class="separator:a5fc42fe6bda022c405d9758888edc8ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77c6077a82a854e401b18d17505ba21"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__mp__simple.html#af77c6077a82a854e401b18d17505ba21">cloud2snow</a> = 0.999</td></tr>
<tr class="separator:af77c6077a82a854e401b18d17505ba21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><hr/>
<p> Very simple microphysics code modeled after the microphysics of SB04 used in Smith and Barstad '04 (the linear model). </p>
<p>Clouds (solid and liquid) form and evaporate instantly Clouds convert to rain (or snow) with a time constant tau [s] typically rain_tau ~500s snow_tau ~2000s Fall speeds in SB04 assume 10m/s (rain) and 1.5m/s (snow). In SB04 this is treated by means of a time constant (=height/speed). Here it is modeled explicitly with these fall speeds</p>
<p>The entry point to the code is mp_simple_driver.</p>
<pre>
 Call tree graph :
 mp_simple_driver-&gt;mp_simple-&gt;
   [mp_conversions-&gt;
       [cloud_conversion-&gt;sat_mr,
        cloud2hydrometeor,
        phase_change],
   sediment]</pre><pre> High level routine descriptions / purpose
   mp_simple_driver    - loops over X,Y grid cells, calls mp_simple on columns
   mp_simple           - calls mp_conversions for all z, then calls sediment
   mp_conversions      - handles all microphysics conversions (e.g. vapor-&gt;cloud-&gt;rain[-&gt;snow-&gt;vapor],...)
   cloud_conversion    - uses sat_mr to calculate sub or supersaturation and changes vapor and cloud water to balance
                          (adjusts temperature for Latent Heating)
   cloud2hydrometeor   - converts cloud water to rain or snow (temperature dependant)
   phase_change        - handles rain and snow evaporation (can take a time constant)
   sediment            - advects falling rain and snow due to gravity (not wind)
   sat_mr              - calculate saturated water vapor mixing ratio</pre><pre> Driver inputs: pressure,th,pii,rho,qv,qc,qr,qs,rain,snow,dt,dz,nx,ny,nz
   pressure   = pressure                      - 3D - input  - Pa     - (nx,nz,ny)
   th         = potential temperature         - 3D - in/out - K      - (nx,nz,ny)
   pii        = exner function                - 3D - input  - []     - (nx,nz,ny)
   rho        = air density                   - 3D - input  - kg/m^3 - (nx,nz,ny)
   qv         = specific humidity             - 3D - in/out - kg/kg  - (nx,nz,ny)
   qc         = cloud water content           - 3D - in/out - kg/kg  - (nx,nz,ny)
   qr         = rain water content            - 3D - in/out - kg/kg  - (nx,nz,ny)
   qs         = snow water content            - 3D - in/out - kg/kg  - (nx,nz,ny)
   rain       = accumulated rain              - 2D - output - mm     - (nx,ny)
   snow       = accumulated snow              - 2D - output - mm     - (nx,ny)
   dt         = time step                     - 0D - input  - sec.   - scalar
   nx         = number of ew grid cells       - 0D - input  - n      - scalar
   ny         = number of ns grid cells       - 0D - input  - n      - scalar
   nz         = number of vertical grid cells - 0D - input  - n      - scalar
 </pre><dl class="section author"><dt>Author</dt><dd>Ethan Gutmann (<a href="#" onclick="location.href='mai'+'lto:'+'gut'+'ma'+'nn@'+'uc'+'ar.'+'ed'+'u'; return false;">gutma<span style="display: none;">.nosp@m.</span>nn@u<span style="display: none;">.nosp@m.</span>car.e<span style="display: none;">.nosp@m.</span>du</a>) <hr/>
 </dd></dl>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a class="anchor" id="a012afbddb9dca5c40bc5bfbe63b275c8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_mp_simple::cloud2hydrometeor </td>
          <td>(</td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>conversion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>qcmin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Convert cloud water or ice to rain or snow </p>
<p>Use a time constant to calculate the convertion between cloud and hydrometeor and enforce reasonable bounds</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qc</td><td>Cloud water (or ice) mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">q</td><td>Rain (or snow) mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">conversion</td><td>time constant for conversion (*dt) [] </td></tr>
    <tr><td class="paramname">qcmin</td><td>minimum cloud content before conversion [kg/kg] <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_a012afbddb9dca5c40bc5bfbe63b275c8_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa0106ae6c82c8b14c49b4afd1871e12b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_mp_simple::cloud_conversion </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>qv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>qvsat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Convert cloud water to vapor and back </p>
<p>Iterates to find the conversion between liquid and vapor including temperature feedbacks</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>air pressure [Pa] </td></tr>
    <tr><td class="paramname">temperature</td><td>air temperature [K] </td></tr>
    <tr><td class="paramname">qv</td><td>water vapor mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">qc</td><td>cloud water mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">qvsat</td><td>saturated mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">dt</td><td>time step [sec.] <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_aa0106ae6c82c8b14c49b4afd1871e12b_cgraph.svg" width="376" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_aa0106ae6c82c8b14c49b4afd1871e12b_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="afa657f819d93fc905ac898e46b0551ce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_mp_simple::mp_conversions </td>
          <td>(</td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>qv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>qr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Compute microphysical conversions </p>
<p>Convert cloud water to and from vapor Convert cloud water to rain, and cloud ice to snow Cloud water is assumed to be ice if temperature is less than 0C Conversions also include latent heat feedbacks to temperature</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>air pressure [Pa] </td></tr>
    <tr><td class="paramname">temperature</td><td>air temperature [K] </td></tr>
    <tr><td class="paramname">qv</td><td>water vapor mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">qc</td><td>cloud water mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">qr</td><td>rain mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">qs</td><td>snow mixing ratio [kg/kg] </td></tr>
    <tr><td class="paramname">dt</td><td>time step [sec.] <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_afa657f819d93fc905ac898e46b0551ce_cgraph.svg" width="664" height="168"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_afa657f819d93fc905ac898e46b0551ce_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac6e0bb6089333d9b063ba5f4e6f8127f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_mp_simple::mp_simple </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nz), intent(inout)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nz), intent(inout)&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nz), intent(inout)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nz), intent(inout)&#160;</td>
          <td class="paramname"><em>qv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nz), intent(inout)&#160;</td>
          <td class="paramname"><em>qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nz), intent(inout)&#160;</td>
          <td class="paramname"><em>qr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nz), intent(inout)&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>rain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nz), intent(in)&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Basic microphysics code for a column of air </p>
<p>Call microphysical conversion routines on each layer and sedimentation for the column</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>= pressure - 1D - input - Pa - (nz) </td></tr>
    <tr><td class="paramname">temperature=</td><td>air temperature - 1D - in/out - K - (nz) </td></tr>
    <tr><td class="paramname">rho</td><td>= air density - 1D - input - kg/m^3 - (nz) </td></tr>
    <tr><td class="paramname">qv</td><td>= specific humidity - 1D - in/out - kg/kg - (nz) </td></tr>
    <tr><td class="paramname">qc</td><td>= cloud water content - 1D - in/out - kg/kg - (nz) </td></tr>
    <tr><td class="paramname">qr</td><td>= rain water content - 1D - in/out - kg/kg - (nz) </td></tr>
    <tr><td class="paramname">qs</td><td>= snow water content - 1D - in/out - kg/kg - (nz) </td></tr>
    <tr><td class="paramname">rain</td><td>= accumulated rain - 0D - output - mm - () </td></tr>
    <tr><td class="paramname">snow</td><td>= accumulated snow - 0D - output - mm - () </td></tr>
    <tr><td class="paramname">dt</td><td>= time step - 0D - input - sec. - scalar </td></tr>
    <tr><td class="paramname">dz</td><td>= vertical thickness of layers - 1D - input - m - (nz) </td></tr>
    <tr><td class="paramname">nz</td><td>= number of vertical grid cells - 0D - input - n - scalar </td></tr>
    <tr><td class="paramname">debug</td><td>= debug mode (print and test) - 0D - input - T/F - Boolean <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_ac6e0bb6089333d9b063ba5f4e6f8127f_cgraph.svg" width="100%" height="503"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_ac6e0bb6089333d9b063ba5f4e6f8127f_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3b5b540d9d511651c42ec6b3ba842796"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_mp_simple::mp_simple_driver </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>pii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>qv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>qr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>rain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx,nz,ny), intent(inout)&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><hr/>
<p> Driver code to control simple microphysics </p>
<p>Handles horizontal spatial dimensions and parallelization in space, Calculates time constants for the current dt, Calculates real temperature from potential temperature</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>= pressure - 3D - input - Pa - (nx,nz,ny) </td></tr>
    <tr><td class="paramname">th</td><td>= potential temperature - 3D - in/out - K - (nx,nz,ny) </td></tr>
    <tr><td class="paramname">pii</td><td>= exner function - 3D - input - [] - (nx,nz,ny) </td></tr>
    <tr><td class="paramname">rho</td><td>= air density - 3D - input - kg/m^3 - (nx,nz,ny) </td></tr>
    <tr><td class="paramname">qv</td><td>= specific humidity - 3D - in/out - kg/kg - (nx,nz,ny) </td></tr>
    <tr><td class="paramname">qc</td><td>= cloud water content - 3D - in/out - kg/kg - (nx,nz,ny) </td></tr>
    <tr><td class="paramname">qr</td><td>= rain water content - 3D - in/out - kg/kg - (nx,nz,ny) </td></tr>
    <tr><td class="paramname">qs</td><td>= snow water content - 3D - in/out - kg/kg - (nx,nz,ny) </td></tr>
    <tr><td class="paramname">rain</td><td>= accumulated rain - 2D - output - mm - (nx,ny) </td></tr>
    <tr><td class="paramname">snow</td><td>= accumulated snow - 2D - output - mm - (nx,ny) </td></tr>
    <tr><td class="paramname">dt</td><td>= time step - 0D - input - sec. - scalar </td></tr>
    <tr><td class="paramname">nx</td><td>= number of ew grid cells - 0D - input - n - scalar </td></tr>
    <tr><td class="paramname">ny</td><td>= number of ns grid cells - 0D - input - n - scalar </td></tr>
    <tr><td class="paramname">nz</td><td>= number of vertical grid cells - 0D - input - n - scalar <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_a3b5b540d9d511651c42ec6b3ba842796_cgraph.svg" width="100%" height="503"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_a3b5b540d9d511651c42ec6b3ba842796_icgraph.svg" width="595" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaf815931c9bfa8e29cd64e1133e8ac4d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_mp_simple::phase_change </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>qmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>Lheat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>change_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Change the "phase" of a hydrometeor (e.g. evaporate rain) </p>
<p>Written to apply generically to any conversion. Convert from q1 (e.g. rain) to q2 (e.g. vapor) using Lheat to affect temperature and change_rate to control the conversion time scale</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>air pressure (not used) [Pa] </td></tr>
    <tr><td class="paramname">temperature</td><td>air temperature [K] </td></tr>
    <tr><td class="paramname">q1</td><td>hydrometeor to convert from [kg/kg] </td></tr>
    <tr><td class="paramname">qmax</td><td>the maximum value for q2 (e.g. qv_sat) [kg/kg] </td></tr>
    <tr><td class="paramname">q2</td><td>hydrometeor to convert to [kg/kg] </td></tr>
    <tr><td class="paramname">Lheat</td><td>latent heat associated with the phase change [J/kg] </td></tr>
    <tr><td class="paramname">change_rate</td><td>fraction of q1 that can change in a timestep [] <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_aaf815931c9bfa8e29cd64e1133e8ac4d_icgraph.svg" width="100%" height="361"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa47fc96f7112b5c4f9718b8f31c79c0c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real function module_mp_simple::sat_mr </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>pressure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Calculate the saturated mixing ratio for a given temperature and pressure </p>
<p>If temperature &gt; 0C: returns the saturated mixing ratio with respect to liquid If temperature &lt; 0C: returns the saturated mixing ratio with respect to ice</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temperature</td><td>Air Temperature [K] </td></tr>
    <tr><td class="paramname">pressure</td><td>Air Pressure [Pa] </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">sat_mr</td><td>Saturated water vapor mixing ratio [kg/kg]</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a href="http://www.dtic.mil/dtic/tr/fulltext/u2/778316.pdf">http://www.dtic.mil/dtic/tr/fulltext/u2/778316.pdf</a> Lowe, P.R. and J.M. Ficke., 1974: The Computation of Saturation Vapor Pressure Environmental Prediction Research Facility, Technical Paper No. 4-74 <hr/>
 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_aa47fc96f7112b5c4f9718b8f31c79c0c_cgraph.svg" width="387" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a555961f80b8e520a047abf3220b1e6df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real function module_mp_simple::sediment </td>
          <td>(</td>
          <td class="paramtype">real, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Compute sedimentation in a column </p>
<p>Takes a mixing ratio of some species along with the fall velocities, air densities and layer thicknesses.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>1D microphysical species to sediment (snow, rain, etc) [kg/kg] </td></tr>
    <tr><td class="paramname">v</td><td>1D vertical velocity [m/s] </td></tr>
    <tr><td class="paramname">rho</td><td>1D air density [kg/m^3] </td></tr>
    <tr><td class="paramname">dz</td><td>1D layer thickness [m] </td></tr>
    <tr><td class="paramname">n</td><td>0D number of layers <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classmodule__mp__simple_a555961f80b8e520a047abf3220b1e6df_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a5fc42fe6bda022c405d9758888edc8ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real module_mp_simple::cloud2rain = 0.999</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af77c6077a82a854e401b18d17505ba21"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real module_mp_simple::cloud2snow = 0.999</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0678d6241005e2b2b201388def7dea90"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::dlhvdt = 2400</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a76bdd584eebc03a02de1cfe7fb6b6d29"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::freezing_threshold = 273.15</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af436151c03526039c23d14802a6c3836"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::heat_capacity = 1006.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a06cd8ef0b9e1fc2acbd8421bb77bb50a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::lh_liquid = 3.34E5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aab329c4184d0117c28286394a41e5861"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::lh_vapor = 2.26E6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af7c50949e2a0b73c5ec9d938fab2e4ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::rain_cloud_init = 0.00001</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afe9e502020c8db2774ff11de20d8d6f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real module_mp_simple::rain_evap = 0.999</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aded1e115bb1032ae4557732622b4a9ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::rain_fall_rate = 10.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af786b5a9c3dccae266836ffa89cbeeb4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::rain_formation_time_const = 1/500.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a41e5eea160014156b15b696dec69b6e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::small_pressure = 1000.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a62767c1c8968f8d3507052ea35d65017"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::small_value = 1E-15</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af6aabb86d8153a2242695dfec50b7ef7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::snow_cloud_init = 0.00001</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae5c905567822928cb1a73d3ae083aa60"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real module_mp_simple::snow_evap = 0.999</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab37514913519ed61be4d1110e16159aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::snow_fall_rate = 1.5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1be4ef8579135d65ad9cb5fce3ce6ebd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_mp_simple::snow_formation_time_const = 1/2000.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a38dd23279d9dffd7f87eaf9e8fe4d047"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real module_mp_simple::snow_melt = 0.999</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this module was generated from the following file:<ul>
<li>physics/<a class="el" href="mp__simple_8f90.html">mp_simple.f90</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
