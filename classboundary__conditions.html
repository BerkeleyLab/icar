<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>The Intermediate Complexity Atmospheric Research model (ICAR): boundary_conditions Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">The Intermediate Complexity Atmospheric Research model (ICAR)
   </div>
   <div id="projectbrief">A computationally efficient atmospheric model for downscaling.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Types</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="moduleboundary__conditions-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">boundary_conditions Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><hr/>
<p> Handles reading boundary conditions from the forcing file(s) Provides necessary interpolation on to the grid.  
 <a href="classboundary__conditions.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5c2fa14c6e1c09f3255e8aa0eb2aa395"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a5c2fa14c6e1c09f3255e8aa0eb2aa395">bc_find_step</a> (options)</td></tr>
<tr class="memdesc:a5c2fa14c6e1c09f3255e8aa0eb2aa395"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Find the time step in the input forcing to start the model on  <a href="#a5c2fa14c6e1c09f3255e8aa0eb2aa395">More...</a><br /></td></tr>
<tr class="separator:a5c2fa14c6e1c09f3255e8aa0eb2aa395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a42f467f470ada98e0a35fd5a75f66"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a07a42f467f470ada98e0a35fd5a75f66">bc_init</a> (domain, bc, options)</td></tr>
<tr class="memdesc:a07a42f467f470ada98e0a35fd5a75f66"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Initialize the boundary conditions (read inital conditions, etc.)  <a href="#a07a42f467f470ada98e0a35fd5a75f66">More...</a><br /></td></tr>
<tr class="separator:a07a42f467f470ada98e0a35fd5a75f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f59398683169f1de9bf8f548f1d7b96"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a3f59398683169f1de9bf8f548f1d7b96">update_pressure</a> (pressure, z_lo, z_hi, lowresT, hiresT)</td></tr>
<tr class="memdesc:a3f59398683169f1de9bf8f548f1d7b96"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Adjust the pressure field for the vertical shift between the low and high-res domains  <a href="#a3f59398683169f1de9bf8f548f1d7b96">More...</a><br /></td></tr>
<tr class="separator:a3f59398683169f1de9bf8f548f1d7b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e8385c37634f3d7f70ea7c749dcda11"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a1e8385c37634f3d7f70ea7c749dcda11">bc_update</a> (domain, bc, options)</td></tr>
<tr class="memdesc:a1e8385c37634f3d7f70ea7c749dcda11"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Read in the next timestep of input data and apply to the dXdt grids as appropriate.  <a href="#a1e8385c37634f3d7f70ea7c749dcda11">More...</a><br /></td></tr>
<tr class="separator:a1e8385c37634f3d7f70ea7c749dcda11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a4ea743610f85b3c52d69af94085b5bfa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a4ea743610f85b3c52d69af94085b5bfa">smooth_wind</a> (<a class="el" href="classwind.html">wind</a>, windowsize, ydim)</td></tr>
<tr class="memdesc:a4ea743610f85b3c52d69af94085b5bfa"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Smooth an array (written for wind but will work for anything)  <a href="#a4ea743610f85b3c52d69af94085b5bfa">More...</a><br /></td></tr>
<tr class="separator:a4ea743610f85b3c52d69af94085b5bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d4ddfc81942b206888c807998f4bb3c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a3d4ddfc81942b206888c807998f4bb3c">read_var</a> (highres, filename, varname, geolut, vlut, <a class="el" href="classboundary__conditions.html#a1b4904a3fef869ca86fd099ca5e60505">curstep</a>, boundary_only, options, z_lo, z_hi, time_varying_zlut, interp_vertical)</td></tr>
<tr class="memdesc:a3d4ddfc81942b206888c807998f4bb3c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Generic routine to read a forcing variable (varname) from a netcdf file (filename) at a time step (curstep)  <a href="#a3d4ddfc81942b206888c807998f4bb3c">More...</a><br /></td></tr>
<tr class="separator:a3d4ddfc81942b206888c807998f4bb3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a092406b0b0b0676f3fcd8e514b1a2663"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a092406b0b0b0676f3fcd8e514b1a2663">read_2dvar</a> (highres, filename, varname, geolut, <a class="el" href="classboundary__conditions.html#a1b4904a3fef869ca86fd099ca5e60505">curstep</a>)</td></tr>
<tr class="memdesc:a092406b0b0b0676f3fcd8e514b1a2663"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Same as read_var but for 2-dimensional data  <a href="#a092406b0b0b0676f3fcd8e514b1a2663">More...</a><br /></td></tr>
<tr class="separator:a092406b0b0b0676f3fcd8e514b1a2663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1208205dcebb05812018d41b6b08e2ce"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a1208205dcebb05812018d41b6b08e2ce">rotate_ext_wind_field</a> (domain, ext_winds)</td></tr>
<tr class="memdesc:a1208205dcebb05812018d41b6b08e2ce"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Rotate winds from real space back to terrain following grid (approximately)  <a href="#a1208205dcebb05812018d41b6b08e2ce">More...</a><br /></td></tr>
<tr class="separator:a1208205dcebb05812018d41b6b08e2ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd8110e2b16915ce0cb12ce4958fe09c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#afd8110e2b16915ce0cb12ce4958fe09c">ext_winds_init</a> (domain, bc, options)</td></tr>
<tr class="memdesc:afd8110e2b16915ce0cb12ce4958fe09c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Initialize the external winds information (filenames, nfiles, etc) and read the initial conditions  <a href="#afd8110e2b16915ce0cb12ce4958fe09c">More...</a><br /></td></tr>
<tr class="separator:afd8110e2b16915ce0cb12ce4958fe09c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4cfb5127bfecdc6e088ef949694ea4a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#ac4cfb5127bfecdc6e088ef949694ea4a">remove_linear_winds</a> (domain, bc, options, filename, <a class="el" href="classboundary__conditions.html#a1b4904a3fef869ca86fd099ca5e60505">curstep</a>)</td></tr>
<tr class="memdesc:ac4cfb5127bfecdc6e088ef949694ea4a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Remove linear theory topographic winds perturbations from the low resolution wind field.  <a href="#ac4cfb5127bfecdc6e088ef949694ea4a">More...</a><br /></td></tr>
<tr class="separator:ac4cfb5127bfecdc6e088ef949694ea4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae46cf75bbe612b68cbc3740d978c4c20"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#ae46cf75bbe612b68cbc3740d978c4c20">mean_boundaries</a> (inputdata)</td></tr>
<tr class="memdesc:ae46cf75bbe612b68cbc3740d978c4c20"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Make the forcing boundary conditions into average values  <a href="#ae46cf75bbe612b68cbc3740d978c4c20">More...</a><br /></td></tr>
<tr class="separator:ae46cf75bbe612b68cbc3740d978c4c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9c319bf80aa129881d9561771af7f3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#afe9c319bf80aa129881d9561771af7f3">mean_winds</a> (domain, filename, <a class="el" href="classboundary__conditions.html#a1b4904a3fef869ca86fd099ca5e60505">curstep</a>, options)</td></tr>
<tr class="memdesc:afe9c319bf80aa129881d9561771af7f3"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Compute the mean wind field and make them constant everywhere...  <a href="#afe9c319bf80aa129881d9561771af7f3">More...</a><br /></td></tr>
<tr class="separator:afe9c319bf80aa129881d9561771af7f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb4a98605fd483895eb2c0f8a27f7026"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#afb4a98605fd483895eb2c0f8a27f7026">check_shapes_3d</a> (data1, data2)</td></tr>
<tr class="memdesc:afb4a98605fd483895eb2c0f8a27f7026"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Check that two model grids have the same shape  <a href="#afb4a98605fd483895eb2c0f8a27f7026">More...</a><br /></td></tr>
<tr class="separator:afb4a98605fd483895eb2c0f8a27f7026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2ea45f7b77ad1c1d998b3ad7d236d89"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#ad2ea45f7b77ad1c1d998b3ad7d236d89">load_restart_file</a> (domain, restart_file, <a class="el" href="classtime__step.html">time_step</a>)</td></tr>
<tr class="memdesc:ad2ea45f7b77ad1c1d998b3ad7d236d89"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Load restart file  <a href="#ad2ea45f7b77ad1c1d998b3ad7d236d89">More...</a><br /></td></tr>
<tr class="separator:ad2ea45f7b77ad1c1d998b3ad7d236d89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac929e30ca12cfd9dadd51b3f3ca091aa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#ac929e30ca12cfd9dadd51b3f3ca091aa">init_znu</a> (domain)</td></tr>
<tr class="memdesc:ac929e30ca12cfd9dadd51b3f3ca091aa"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Calculate the ZNU and ZNW variables  <a href="#ac929e30ca12cfd9dadd51b3f3ca091aa">More...</a><br /></td></tr>
<tr class="separator:ac929e30ca12cfd9dadd51b3f3ca091aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa932f1eab14409119005a8d673e3dc7e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#aa932f1eab14409119005a8d673e3dc7e">update_edges</a> (dx_dt, d1, d2)</td></tr>
<tr class="memdesc:aa932f1eab14409119005a8d673e3dc7e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Same as update_dxdt but only for the edges of the domains  <a href="#aa932f1eab14409119005a8d673e3dc7e">More...</a><br /></td></tr>
<tr class="separator:aa932f1eab14409119005a8d673e3dc7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59c7f74c734cc083800659cb24213051"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a59c7f74c734cc083800659cb24213051">update_dxdt</a> (bc, domain)</td></tr>
<tr class="memdesc:a59c7f74c734cc083800659cb24213051"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Calculate changes between the current boundary conditions and the time step boundary conditions  <a href="#a59c7f74c734cc083800659cb24213051">More...</a><br /></td></tr>
<tr class="separator:a59c7f74c734cc083800659cb24213051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a998dc0c12296bf212c332fec4708b86f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a998dc0c12296bf212c332fec4708b86f">update_dwinddt</a> (bc, domain)</td></tr>
<tr class="memdesc:a998dc0c12296bf212c332fec4708b86f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Calculate changes in winds between the current and future conditions  <a href="#a998dc0c12296bf212c332fec4708b86f">More...</a><br /></td></tr>
<tr class="separator:a998dc0c12296bf212c332fec4708b86f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40ba01db58736c2bb018af7ebe72f55f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a40ba01db58736c2bb018af7ebe72f55f">update_ext_winds</a> (bc, options)</td></tr>
<tr class="memdesc:a40ba01db58736c2bb018af7ebe72f55f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><hr/>
<p> Update the external wind field  <a href="#a40ba01db58736c2bb018af7ebe72f55f">More...</a><br /></td></tr>
<tr class="separator:a40ba01db58736c2bb018af7ebe72f55f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af09c0f9aef6a323df6fb044ffe596b40"><td class="memItemLeft" align="right" valign="top">character(len=255), dimension(:), <br class="typebreak" />
allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#af09c0f9aef6a323df6fb044ffe596b40">file_list</a></td></tr>
<tr class="separator:af09c0f9aef6a323df6fb044ffe596b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a851e77af1011569e96d9fee796182e24"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a851e77af1011569e96d9fee796182e24">curfile</a></td></tr>
<tr class="separator:a851e77af1011569e96d9fee796182e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b4904a3fef869ca86fd099ca5e60505"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a1b4904a3fef869ca86fd099ca5e60505">curstep</a></td></tr>
<tr class="separator:a1b4904a3fef869ca86fd099ca5e60505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add4947ac8c182a5b16bee42102657ed6"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#add4947ac8c182a5b16bee42102657ed6">steps_in_file</a></td></tr>
<tr class="separator:add4947ac8c182a5b16bee42102657ed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e9d831f507788e931478f3688f85ad1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a4e9d831f507788e931478f3688f85ad1">nfiles</a></td></tr>
<tr class="separator:a4e9d831f507788e931478f3688f85ad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb5d56cad3d42a26935602a49ac716d3"><td class="memItemLeft" align="right" valign="top">character(len=255), dimension(:), <br class="typebreak" />
allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#afb5d56cad3d42a26935602a49ac716d3">ext_winds_file_list</a></td></tr>
<tr class="separator:afb5d56cad3d42a26935602a49ac716d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20929abba489ee6796a5681ae3d9a7d1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a20929abba489ee6796a5681ae3d9a7d1">ext_winds_curfile</a></td></tr>
<tr class="separator:a20929abba489ee6796a5681ae3d9a7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7057d0c2a315cb244239a694a6849c43"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a7057d0c2a315cb244239a694a6849c43">ext_winds_curstep</a></td></tr>
<tr class="separator:a7057d0c2a315cb244239a694a6849c43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab586d81c3eae68d56308d9e5d7d17eaa"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#ab586d81c3eae68d56308d9e5d7d17eaa">ext_winds_steps_in_file</a></td></tr>
<tr class="separator:ab586d81c3eae68d56308d9e5d7d17eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67fbe913d242f54d160e56fb22da52e4"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#a67fbe913d242f54d160e56fb22da52e4">ext_winds_nfiles</a></td></tr>
<tr class="separator:a67fbe913d242f54d160e56fb22da52e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5d3d785e90e55d2cc50c4b6c09d89f1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classboundary__conditions.html#af5d3d785e90e55d2cc50c4b6c09d89f1">smoothing_window</a> =1</td></tr>
<tr class="separator:af5d3d785e90e55d2cc50c4b6c09d89f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><hr/>
<p> Handles reading boundary conditions from the forcing file(s) Provides necessary interpolation on to the grid. </p>
<pre>
  Primary entry points 
      bc_init      - first call only
      bc_update    - all successive calls</pre><pre>  Contains options to use the 
      mean wind field
      mean boundary forcing
      wind field smoothing
      removal of low resolution model linear wind field</pre><pre>  bc_init loads the restart file as necessary.</pre><pre>  Both init and update compute the exner function and density fields
  for the forcing step and update the wind field with linear perturbations
  as necessary
 </pre><dl class="section author"><dt>Author</dt><dd>Ethan Gutmann (<a href="#" onclick="location.href='mai'+'lto:'+'gut'+'ma'+'nn@'+'uc'+'ar.'+'ed'+'u'; return false;">gutma<span style="display: none;">.nosp@m.</span>nn@u<span style="display: none;">.nosp@m.</span>car.e<span style="display: none;">.nosp@m.</span>du</a>) <hr/>
 </dd></dl>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a class="anchor" id="a5c2fa14c6e1c09f3255e8aa0eb2aa395"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public boundary_conditions::bc_find_step </td>
          <td>(</td>
          <td class="paramtype">type(options_type), intent(in)&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><hr/>
<p> Find the time step in the input forcing to start the model on </p>
<p>The model start date (start_mjd) may not be the same as the first forcing date (initial_mjd). Convert the difference between the two into forcing steps by dividing by the time delta between forcing steps (in_dt) after converting in_dt from seconds to days.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">options</td><td>model options structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">step</td><td>integer number of steps into the forcing sequence <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a5c2fa14c6e1c09f3255e8aa0eb2aa395_icgraph.svg" width="432" height="82"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a07a42f467f470ada98e0a35fd5a75f66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public boundary_conditions::bc_init </td>
          <td>(</td>
          <td class="paramtype">type(domain_type), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bc_type), intent(inout)&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type), intent(in)&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><hr/>
<p> Initialize the boundary conditions (read inital conditions, etc.) </p>
<p>This is one of the most important subroutines, and is nearly identical to bc_update This reads the first forcing time step in, calling relevant subroutines as dictated by the options specified (e.g. mean_winds, external_winds)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>Model Domain </td></tr>
    <tr><td class="paramname">bc</td><td>Model forcing boundary conditions data structure </td></tr>
    <tr><td class="paramname">options</td><td>Model Options structure <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a07a42f467f470ada98e0a35fd5a75f66_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a07a42f467f470ada98e0a35fd5a75f66_icgraph.svg" width="243" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1e8385c37634f3d7f70ea7c749dcda11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public boundary_conditions::bc_update </td>
          <td>(</td>
          <td class="paramtype">type(domain_type), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bc_type), intent(inout)&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type), intent(in)&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><hr/>
<p> Read in the next timestep of input data and apply to the dXdt grids as appropriate. </p>
<p>Nearly identical to bc_init. Primary differences are that: Restart fields are not checked for and read, and data are stored in bcnext_domain instead of domain In addition, the time_varying_z condition is handled here with an additional interpolation. Finally, current domain conditions are copied into next_domain (after computing dxdt values) for use in the linear_wind calculations (i.e. linear wind field for the next time step is calculated based on atmospheric stability conditions for the current time step).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>Model Domain </td></tr>
    <tr><td class="paramname">bc</td><td>Model forcing boundary conditions data structure </td></tr>
    <tr><td class="paramname">options</td><td>Model Options structure <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a1e8385c37634f3d7f70ea7c749dcda11_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a1e8385c37634f3d7f70ea7c749dcda11_icgraph.svg" width="243" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="afb4a98605fd483895eb2c0f8a27f7026"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::check_shapes_3d </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>data1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>data2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Check that two model grids have the same shape </p>
<p>If the size of all dimensions in data1 and data2 are not exactly the same the model will stop</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data1</td><td>First 3D array to check dimension sizes </td></tr>
    <tr><td class="paramname">data2</td><td>Second 3D array to check dimension sizes <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_afb4a98605fd483895eb2c0f8a27f7026_icgraph.svg" width="622" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="afd8110e2b16915ce0cb12ce4958fe09c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::ext_winds_init </td>
          <td>(</td>
          <td class="paramtype">type(domain_type), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bc_type), intent(inout)&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type), intent(in)&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Initialize the external winds information (filenames, nfiles, etc) and read the initial conditions </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>Model Domain </td></tr>
    <tr><td class="paramname">bc</td><td>Model forcing boundary conditions data structure </td></tr>
    <tr><td class="paramname">options</td><td>Model Options structure <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_afd8110e2b16915ce0cb12ce4958fe09c_cgraph.svg" width="100%" height="514"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_afd8110e2b16915ce0cb12ce4958fe09c_icgraph.svg" width="432" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac929e30ca12cfd9dadd51b3f3ca091aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::init_znu </td>
          <td>(</td>
          <td class="paramtype">type(domain_type), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Calculate the ZNU and ZNW variables </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>Model domain structure <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_ac929e30ca12cfd9dadd51b3f3ca091aa_icgraph.svg" width="432" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad2ea45f7b77ad1c1d998b3ad7d236d89"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::load_restart_file </td>
          <td>(</td>
          <td class="paramtype">type(domain_type), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>restart_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>time_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Load restart file </p>
<p>If we are restarting from a given point, initialize the domain from the given restart file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>Model domain </td></tr>
    <tr><td class="paramname">restart_file</td><td>Name of the file to read restart data from </td></tr>
    <tr><td class="paramname"><a class="el" href="classtime__step.html" title=" Main time stepping module. Calculates a stable time step (dt) and loops over physics calls Also upda...">time_step</a></td><td>Time step in restart_file to read. <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_ad2ea45f7b77ad1c1d998b3ad7d236d89_cgraph.svg" width="531" height="247"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_ad2ea45f7b77ad1c1d998b3ad7d236d89_icgraph.svg" width="432" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae46cf75bbe612b68cbc3740d978c4c20"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::mean_boundaries </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>inputdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Make the forcing boundary conditions into average values </p>
<p>Averages are computed independantly for each level and each side of the model</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputdata</td><td>3D Array to compute means over the boundaries <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_ae46cf75bbe612b68cbc3740d978c4c20_icgraph.svg" width="432" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="afe9c319bf80aa129881d9561771af7f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::mean_winds </td>
          <td>(</td>
          <td class="paramtype">type(domain_type), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>curstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type)&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Compute the mean wind field and make them constant everywhere... </p>
<p>Averages are computed over the entire domain. U and V are read in hear to avoid the cost of first interpolating them to the high-res grid. BUT this means that a much larger domain then the one ICAR is actually running on is used, so it should be changed to use the high-res grid...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>Model Domain </td></tr>
    <tr><td class="paramname">filename</td><td>Name of the file to read the current boundary conditions forcing from (as in read_var) </td></tr>
    <tr><td class="paramname">curstep</td><td>Time step in forcing file to read </td></tr>
    <tr><td class="paramname">options</td><td>Model Options structure <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_afe9c319bf80aa129881d9561771af7f3_cgraph.svg" width="336" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_afe9c319bf80aa129881d9561771af7f3_icgraph.svg" width="432" height="116"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a092406b0b0b0676f3fcd8e514b1a2663"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::read_2dvar </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>highres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(geo_look_up_table), intent(in)&#160;</td>
          <td class="paramname"><em>geolut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>curstep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Same as read_var but for 2-dimensional data </p>
<p>Data are read and horizontally interpolated. This routine is simpler because it is used For a more limited set of variables, and they are simpler 2D instead of 3D. Primarily used for surface variables: Sensible and latent heat fluxes, PBL height, skin temperature, radiation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">highres</td><td>Allocated input array to store the result. </td></tr>
    <tr><td class="paramname">filename</td><td>Name of the NetCDF file to read. </td></tr>
    <tr><td class="paramname">varname</td><td>Name of the variable to read from &lt;filename&gt;. </td></tr>
    <tr><td class="paramname">geolut</td><td>Geographic Look Up Table that defines the 2D horizontal interpolation. </td></tr>
    <tr><td class="paramname">curstep</td><td>The time step in &lt;filename&gt; to read. <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a092406b0b0b0676f3fcd8e514b1a2663_cgraph.svg" width="336" height="103"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a092406b0b0b0676f3fcd8e514b1a2663_icgraph.svg" width="432" height="116"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3d4ddfc81942b206888c807998f4bb3c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::read_var </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>highres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(geo_look_up_table), intent(in)&#160;</td>
          <td class="paramname"><em>geolut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(vert_look_up_table), intent(in)&#160;</td>
          <td class="paramname"><em>vlut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>curstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>boundary_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type), intent(in)&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>z_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>z_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(vert_look_up_table), intent(in), optional&#160;</td>
          <td class="paramname"><em>time_varying_zlut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>interp_vertical</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Generic routine to read a forcing variable (varname) from a netcdf file (filename) at a time step (curstep) </p>
<p>Data are interpolated to the high res grid either in 3D or at the boundaries only (boundary_only) Applies modifications specificaly for U,V,T, and P variables</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">highres</td><td>Allocated input array to store the result. </td></tr>
    <tr><td class="paramname">filename</td><td>Name of the NetCDF file to read. </td></tr>
    <tr><td class="paramname">varname</td><td>Name of the variable to read from &lt;filename&gt;. </td></tr>
    <tr><td class="paramname">geolut</td><td>Geographic Look Up Table that defines the 2D horizontal interpolation. </td></tr>
    <tr><td class="paramname">vlut</td><td>Vertical Look Up table that defines the vertical interpolation. </td></tr>
    <tr><td class="paramname">curstep</td><td>The time step in &lt;filename&gt; to read. </td></tr>
    <tr><td class="paramname">boundary_only</td><td>Logical:interpolate to all points or just to boundaries </td></tr>
    <tr><td class="paramname">options</td><td>Model options structure </td></tr>
    <tr><td class="paramname">z_lo</td><td>Low-resolution (input) 3D vertical coordinate for pressure adjustment. [meters] </td></tr>
    <tr><td class="paramname">z_hi</td><td>High-resolution (output) 3D vertical coordinate for pressure adjustment. [meters] </td></tr>
    <tr><td class="paramname">time_varying_zlut</td><td>Logical: if true, first adjust the low-resolution data to a common vertical coordinate </td></tr>
    <tr><td class="paramname">interp_vertical</td><td>Logical: if true, perform vertical interpolation (false for pressure) <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a3d4ddfc81942b206888c807998f4bb3c_cgraph.svg" width="560" height="234"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a3d4ddfc81942b206888c807998f4bb3c_icgraph.svg" width="622" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac4cfb5127bfecdc6e088ef949694ea4a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::remove_linear_winds </td>
          <td>(</td>
          <td class="paramtype">type(domain_type), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bc_type), intent(inout)&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type), intent(in)&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>curstep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Remove linear theory topographic winds perturbations from the low resolution wind field. </p>
<p>NOTE: this may not work at the moment (and certainly won't with the Linear wind look up table option)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>Model Domain </td></tr>
    <tr><td class="paramname">bc</td><td>Model forcing boundary conditions data structure </td></tr>
    <tr><td class="paramname">options</td><td>Model Options structure </td></tr>
    <tr><td class="paramname">filename</td><td>Name of the file to read the current boundary conditions forcing from (as in read_var) </td></tr>
    <tr><td class="paramname">curstep</td><td>Time step in forcing file to read <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_ac4cfb5127bfecdc6e088ef949694ea4a_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_ac4cfb5127bfecdc6e088ef949694ea4a_icgraph.svg" width="443" height="116"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1208205dcebb05812018d41b6b08e2ce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::rotate_ext_wind_field </td>
          <td>(</td>
          <td class="paramtype">type(domain_type), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(wind_type), intent(inout)&#160;</td>
          <td class="paramname"><em>ext_winds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Rotate winds from real space back to terrain following grid (approximately) </p>
<p>Only used for external winds. Assumes a simple slope transform in u and v independantly constant w/height</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>Full model domain </td></tr>
    <tr><td class="paramname">ext_winds</td><td>External wind data structure <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a1208205dcebb05812018d41b6b08e2ce_icgraph.svg" width="635" height="116"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4ea743610f85b3c52d69af94085b5bfa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::smooth_wind </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>wind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>windowsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ydim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Smooth an array (written for wind but will work for anything) </p>
<p>Only smooths over the first (x) and second (y or z) or third (y or z) dimension ydim can be specified to allow working with (x,y,z) data or (x,z,y) data WARNING: this is a moderately complex setup to be efficient for the ydim=3 (typically large arrays, SLOW) case be careful when editing. For the complex case it pre-computes the sum of all columns for a given row, then to move from one column to the next it just has add the next column from the sums and subtracts the last one similarly, moving to the next row just means adding the next row to the sums, and subtracting the last one. Each point also has to be divided by N, but this decreases the compution from O(windowsize^2) to O(constant) Where O(constant) = 2 additions, 2 subtractions, and 1 divide regardless of windowsize!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wind</td><td>3D array to be smoothed </td></tr>
    <tr><td class="paramname">windowsize</td><td>size to smooth in both directions (i.e. the full window is this * 2 + 1) </td></tr>
    <tr><td class="paramname">ysim</td><td>axis the y dimension is on (2 or 3) in the wind array <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a4ea743610f85b3c52d69af94085b5bfa_icgraph.svg" width="100%" height="532"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a998dc0c12296bf212c332fec4708b86f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::update_dwinddt </td>
          <td>(</td>
          <td class="paramtype">type(bc_type), intent(inout)&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(domain_type), intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Calculate changes in winds between the current and future conditions </p>
<p>These changes are used to linearly shift all fields between the two times.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bc</td><td>Model boundary forcing conditions data structure (future conditions and changes) </td></tr>
    <tr><td class="paramname">domain</td><td>Model domain data structure (current conditions) <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a998dc0c12296bf212c332fec4708b86f_icgraph.svg" width="432" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a59c7f74c734cc083800659cb24213051"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::update_dxdt </td>
          <td>(</td>
          <td class="paramtype">type(bc_type), intent(inout)&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(domain_type), intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Calculate changes between the current boundary conditions and the time step boundary conditions </p>
<p>These changes are used to linearly shift all fields between the two times.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bc</td><td>Model boundary forcing conditions data structure (future conditions and changes) </td></tr>
    <tr><td class="paramname">domain</td><td>Model domain data structure (current conditions) <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a59c7f74c734cc083800659cb24213051_cgraph.svg" width="342" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a59c7f74c734cc083800659cb24213051_icgraph.svg" width="432" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa932f1eab14409119005a8d673e3dc7e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::update_edges </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>dx_dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>d1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>d2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Same as update_dxdt but only for the edges of the domains </p>
<p>This is used for fields that are calculated/updated internally by the model physics (e.g. temperature and moisture) In the output dxdt variable, the first dimension is the z axis, The second dimension is either X or Y (which ever is specified) And the third dimension specifies the boundary it applies to 1=left, 2=right, 3=bottom, 4=top</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dx_dt</td><td>Change in variable X between time periods d1 and d2 </td></tr>
    <tr><td class="paramname">d1</td><td>Value of field X at time period 1 </td></tr>
    <tr><td class="paramname">d2</td><td>Value of field X at time period 2 </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">dx_dt</td><td>This field is updated along the boundaries to be (d1-d2) <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_aa932f1eab14409119005a8d673e3dc7e_icgraph.svg" width="622" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a40ba01db58736c2bb018af7ebe72f55f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine boundary_conditions::update_ext_winds </td>
          <td>(</td>
          <td class="paramtype">type(bc_type), intent(inout)&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(options_type), intent(in)&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><hr/>
<p> Update the external wind field </p>
<p>Read U and V and rotate into the domain 3D grid, store in bcnext_domain</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bc</td><td>Model forcing boundary conditions data structure </td></tr>
    <tr><td class="paramname">options</td><td>Model Options structure <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a40ba01db58736c2bb018af7ebe72f55f_cgraph.svg" width="100%" height="514"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a40ba01db58736c2bb018af7ebe72f55f_icgraph.svg" width="432" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f59398683169f1de9bf8f548f1d7b96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public boundary_conditions::update_pressure </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>z_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>z_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>lowresT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>hiresT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><hr/>
<p> Adjust the pressure field for the vertical shift between the low and high-res domains </p>
<p>Ideally this should include temperature... but it isn't entirely clear what it would mean to do that, what temperature do you use? Current even though you are adjusting future P? Alternatively, could adjust input pressure to SLP with future T then adjust back to elevation with current T? Currently if T is supplied, it uses the mean of the high and low-res T to split the difference. Equations from : <a href="http://www.wmo.int/pages/prog/www/IMOP/meetings/SI/ET-Stand-1/Doc-10_Pressure-red.pdf">http://www.wmo.int/pages/prog/www/IMOP/meetings/SI/ET-Stand-1/Doc-10_Pressure-red.pdf</a> excerpt from CIMO Guide, Part I, Chapter 3 (Edition 2008, Updated in 2010) equation 3.2 <a href="http://www.meteormetrics.com/correctiontosealevel.htm">http://www.meteormetrics.com/correctiontosealevel.htm</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>The pressure field to be adjusted </td></tr>
    <tr><td class="paramname">z_lo</td><td>The 3D vertical coordinate of the input pressures </td></tr>
    <tr><td class="paramname">z_hi</td><td>The 3D vertical coordinate of the computed/adjusted pressures </td></tr>
    <tr><td class="paramname">lowresT</td><td>OPTIONAL 3D temperature field of the input pressures </td></tr>
    <tr><td class="paramname">lowresT</td><td>OPTIONAL 3D temperature field of the computed/adjusted pressures </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">pressure</td><td>The pressure field after adjustment <hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classboundary__conditions_a3f59398683169f1de9bf8f548f1d7b96_icgraph.svg" width="100%" height="441"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a851e77af1011569e96d9fee796182e24"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::curfile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1b4904a3fef869ca86fd099ca5e60505"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::curstep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a20929abba489ee6796a5681ae3d9a7d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::ext_winds_curfile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7057d0c2a315cb244239a694a6849c43"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::ext_winds_curstep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afb5d56cad3d42a26935602a49ac716d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character (len=255), dimension(:), allocatable boundary_conditions::ext_winds_file_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a67fbe913d242f54d160e56fb22da52e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::ext_winds_nfiles</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab586d81c3eae68d56308d9e5d7d17eaa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::ext_winds_steps_in_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af09c0f9aef6a323df6fb044ffe596b40"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character (len=255), dimension(:), allocatable boundary_conditions::file_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4e9d831f507788e931478f3688f85ad1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::nfiles</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af5d3d785e90e55d2cc50c4b6c09d89f1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::smoothing_window =1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="add4947ac8c182a5b16bee42102657ed6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer boundary_conditions::steps_in_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this module was generated from the following file:<ul>
<li>main/<a class="el" href="boundary_8f90.html">boundary.f90</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
