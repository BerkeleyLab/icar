<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>The Intermediate Complexity Atmospheric Research model (ICAR): main/boundary.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Types&nbsp;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>main/boundary.f90 File Reference</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">module &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html">boundary_conditions</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>------------------------------------------------------------ Handles reading boundary conditions from the forcing file(s) Provides necessary interpolation on to the grid. </p>
<br/></td></tr>
</p>
<tr><td colspan="2"><h2>Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#ab403f9bcf3720b8ad873aadbeb7db88f">boundary_conditions::bc_find_step</a> (options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Find the <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step in the input forcing to start the model on  <a href="#ab403f9bcf3720b8ad873aadbeb7db88f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a4ea743610f85b3c52d69af94085b5bfa">boundary_conditions::smooth_wind</a> (wind, windowsize, ydim)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Smooth an array (written for <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> but will work for anything)  <a href="#a4ea743610f85b3c52d69af94085b5bfa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a3d4ddfc81942b206888c807998f4bb3c">boundary_conditions::read_var</a> (highres, filename, varname, geolut, vlut, curstep, boundary_only, options, z_lo, z_hi, time_varying_zlut, interp_vertical)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Generic routine to read a forcing variable (varname) from a netcdf file (filename) at a <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step (curstep)  <a href="#a3d4ddfc81942b206888c807998f4bb3c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a092406b0b0b0676f3fcd8e514b1a2663">boundary_conditions::read_2dvar</a> (highres, filename, varname, geolut, curstep)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Same as read_var but for 2-dimensional data  <a href="#a092406b0b0b0676f3fcd8e514b1a2663"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a1208205dcebb05812018d41b6b08e2ce">boundary_conditions::rotate_ext_wind_field</a> (domain, ext_winds)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Rotate winds from real space back to terrain following grid (approximately)  <a href="#a1208205dcebb05812018d41b6b08e2ce"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#afd8110e2b16915ce0cb12ce4958fe09c">boundary_conditions::ext_winds_init</a> (domain, bc, options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Initialize the external winds information (filenames, nfiles, etc) and read the initial conditions  <a href="#afd8110e2b16915ce0cb12ce4958fe09c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#ac4cfb5127bfecdc6e088ef949694ea4a">boundary_conditions::remove_linear_winds</a> (domain, bc, options, filename, curstep)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Remove linear theory topographic winds perturbations from the low resolution <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> field.  <a href="#ac4cfb5127bfecdc6e088ef949694ea4a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#ae46cf75bbe612b68cbc3740d978c4c20">boundary_conditions::mean_boundaries</a> (inputdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Make the forcing boundary conditions into average values  <a href="#ae46cf75bbe612b68cbc3740d978c4c20"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#afe9c319bf80aa129881d9561771af7f3">boundary_conditions::mean_winds</a> (domain, filename, curstep, options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Compute the mean <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> field and make them constant everywhere...  <a href="#afe9c319bf80aa129881d9561771af7f3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#afb4a98605fd483895eb2c0f8a27f7026">boundary_conditions::check_shapes_3d</a> (data1, data2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Check that two model grids have the same shape  <a href="#afb4a98605fd483895eb2c0f8a27f7026"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#aa517afe1f0fdcd1f813378365d4c0a8d">boundary_conditions::swap_y_z_dimensions</a> (data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Swap the last two dimensions of an array  <a href="#aa517afe1f0fdcd1f813378365d4c0a8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#ad2ea45f7b77ad1c1d998b3ad7d236d89">boundary_conditions::load_restart_file</a> (domain, restart_file, time_step)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Load restart file  <a href="#ad2ea45f7b77ad1c1d998b3ad7d236d89"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#ac929e30ca12cfd9dadd51b3f3ca091aa">boundary_conditions::init_znu</a> (domain)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Calculate the ZNU and ZNW variables  <a href="#ac929e30ca12cfd9dadd51b3f3ca091aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#aa3b2c5f5b780342439cce2fd39d0cedc">boundary_conditions::bc_init</a> (domain, bc, options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Initialize the boundary conditions (read inital conditions, etc.)  <a href="#aa3b2c5f5b780342439cce2fd39d0cedc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#aa932f1eab14409119005a8d673e3dc7e">boundary_conditions::update_edges</a> (dx_dt, d1, d2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Same as update_dxdt but only for the edges of the domains  <a href="#aa932f1eab14409119005a8d673e3dc7e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a59c7f74c734cc083800659cb24213051">boundary_conditions::update_dxdt</a> (bc, domain)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Calculate changes between the current boundary conditions and the <a class="el" href="namespacetime.html" title="------------------------------------------------------------ date / time module">time</a> step boundary conditions  <a href="#a59c7f74c734cc083800659cb24213051"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a998dc0c12296bf212c332fec4708b86f">boundary_conditions::update_dwinddt</a> (bc, domain)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Calculate changes in winds between the current and future conditions  <a href="#a998dc0c12296bf212c332fec4708b86f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a2444404168e4c2647d5d469702aadc14">boundary_conditions::update_pressure</a> (pressure, z_lo, z_hi, lowresT, hiresT)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Adjust the pressure field for the vertical shift between the low and high-res domains  <a href="#a2444404168e4c2647d5d469702aadc14"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a40ba01db58736c2bb018af7ebe72f55f">boundary_conditions::update_ext_winds</a> (bc, options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Update the external <a class="el" href="namespacewind.html" title="------------------------------------------------------------ Module to manage the...">wind</a> field  <a href="#a40ba01db58736c2bb018af7ebe72f55f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#ac33b619bc84b9e33bf913987f8793e6d">boundary_conditions::bc_update</a> (domain, bc, options)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">------------------------------------------------------------ Read in the next timestep of input data and apply to the dXdt grids as appropriate.  <a href="#ac33b619bc84b9e33bf913987f8793e6d"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">character(len=255), dimension(:), <br class="typebreak"/>
allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a49a859972db1346a9b04d7ce4f26e016">boundary_conditions::file_list</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a851e77af1011569e96d9fee796182e24">boundary_conditions::curfile</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a1b4904a3fef869ca86fd099ca5e60505">boundary_conditions::curstep</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#add4947ac8c182a5b16bee42102657ed6">boundary_conditions::steps_in_file</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a4e9d831f507788e931478f3688f85ad1">boundary_conditions::nfiles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">character(len=255), dimension(:), <br class="typebreak"/>
allocatable&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a4536c3ee96efacaa675b1c8d072ccd27">boundary_conditions::ext_winds_file_list</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a20929abba489ee6796a5681ae3d9a7d1">boundary_conditions::ext_winds_curfile</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a7057d0c2a315cb244239a694a6849c43">boundary_conditions::ext_winds_curstep</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#ab586d81c3eae68d56308d9e5d7d17eaa">boundary_conditions::ext_winds_steps_in_file</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#a67fbe913d242f54d160e56fb22da52e4">boundary_conditions::ext_winds_nfiles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">integer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceboundary__conditions.html#af5d3d785e90e55d2cc50c4b6c09d89f1">boundary_conditions::smoothing_window</a> = 1</td></tr>
</table>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 12 May 2016 for The Intermediate Complexity Atmospheric Research model (ICAR) by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
